<!DOCTYPE html>
<html lang="es">

<head>
    <base href="./" />
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Calculadora Trading Pro - Ratio Personalizado</title>
    <style>
        .card {
            background: white;
            padding: 25px;
            width: 100%;
            max-width: 500px;
        }

        h2 {
            color: #1a237e;
            text-align: center;
            border-bottom: 2px solid #e3f2fd;
            padding-bottom: 10px;
            margin-bottom: 20px;
        }

        .input-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            margin-bottom: 20px;
        }

        label {
            display: block;
            margin-bottom: 5px;
            color: #546e7a;
            font-size: 0.85em;
            font-weight: bold;
        }

        input,
        select {
            width: 100%;
            padding: 12px;
            border: 1px solid #cfd8dc;
            border-radius: 8px;
            box-sizing: border-box;
            font-size: 15px;
            background: #fff;
        }

        .header-section {
            font-size: 0.8em;
            font-weight: bold;
            color: #90a4ae;
            margin-top: 15px;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .results {
            margin-top: 10px;
            display: grid;
            gap: 8px;
        }

        .res-item {
            display: flex;
            justify-content: space-between;
            padding: 12px;
            border-radius: 8px;
            background: #f8f9fa;
            transition: 0.3s;
        }

        .danger {
            background: #ffebee;
            color: #c62828;
            border-left: 5px solid #c62828;
        }

        .success {
            background: #e8f5e9;
            color: #2e7d32;
            border-left: 5px solid #2e7d32;
            font-size: 1.1em;
        }

        .info {
            background: #e3f2fd;
            color: #1565c0;
            border-left: 5px solid #1565c0;
        }

        .res-value {
            font-weight: bold;
        }
    </style>

    <!--bootstrap-->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
        integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.min.js"
        integrity="sha384-0pUGZvbkm6XF6gxjEnlmuGrJXVbNuzT9qBBavbLwCsOGabYfZo0T0to5eqruptLy"
        crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz"
        crossorigin="anonymous"></script>

    <!-- services -->
    <script src="src/services/store.service.js"></script>
    <script src="src/services/utils.service.js"></script>

    <!--components-->
    <script src="./src/components/wcHeader/wcHeader.component.js"></script>
</head>

<body>

    <wc-header></wc-header>

    <section class="p-3">
        <div class="card">
            <h2>Estrategia Swing Pro</h2>

            <div class="input-grid">
                <div class="input-group">
                    <label>Capital Cuenta (€)</label>
                    <input type="number" id="capital" value="2000" oninput="calcular()">
                </div>
                <div class="input-group">
                    <label>% Riesgo Máx.</label>
                    <input type="number" id="riesgo" value="1" step="0.1" oninput="calcular()">
                </div>
                <div class="input-group">
                    <label>Precio Entrada (€)</label>
                    <input type="number" id="entrada" value="0" step="0.01" oninput="calcular()">
                </div>
                <div class="input-group">
                    <label>Stop Loss (€)</label>
                    <input type="number" id="stop" value="0" step="0.01" oninput="calcular()">
                </div>
                <div class="input-group" style="grid-column: span 2;">
                    <label>Ratio Riesgo/Beneficio (1:X)</label>
                    <select id="ratio" onchange="calcular()">
                        <option value="1.5">1:1.5 (Conservador)</option>
                        <option value="2" selected>1:2 (Estándar)</option>
                        <option value="2.5">1:2.5 (Recomendado)</option>
                        <option value="3">1:3 (Agresivo)</option>
                        <option value="4">1:4 (Tendencial)</option>
                    </select>
                </div>
            </div>

            <div class="header-section">Plan de Ejecución</div>
            <div class="results">
                <div class="res-item">
                    <span>Comprar: <strong id="resAcciones">0</strong> acciones</span>
                    <span>Total: <strong id="resInversion">0€</strong></span>
                </div>
                <div class="res-item danger">
                    <span>Stop Loss en: <strong id="resStopPrecio">0€</strong></span>
                    <span id="resRiesgoReal">-0€</span>
                </div>
                <div class="res-item info">
                    <span>Mover a Break-Even en: <strong id="resActivacion">0€</strong></span>
                    <!-- <span class="res-value" id="resActivacion">0€</span> -->
                </div>
                <div class="res-item success">
                    <span>Vender en (Take Profit): <strong id="resTarget">0€</strong></span>
                    <span id="resBeneficioReal">+0€</span>
                </div>
            </div>
        </div>

    </section>



    <script>

        function calcular() {
            const cap = parseFloat(document.getElementById('capital').value) || 0;
            const ent = parseFloat(document.getElementById('entrada').value) || 0;
            const stop = parseFloat(document.getElementById('stop').value) || 0;
            const rie = parseFloat(document.getElementById('riesgo').value) || 0;
            const ratio = parseFloat(document.getElementById('ratio').value) || 2;

            if (ent > stop && cap > 0 && ent > 0) {
                const riesgoEurosMax = cap * (rie / 100);
                const distanciaStop = ent - stop;
                const numAcciones = Math.floor(riesgoEurosMax / distanciaStop);

                const inversionTotal = numAcciones * ent;
                const riesgoRealEuros = numAcciones * distanciaStop;
                const targetPrecio = ent + (distanciaStop * ratio);
                const beneficioRealEuros = riesgoRealEuros * ratio;
                const puntoBE = ent + distanciaStop;

                document.getElementById('resAcciones').innerText = numAcciones;
                document.getElementById('resInversion').innerText = inversionTotal.toFixed(2) + "€";
                document.getElementById('resStopPrecio').innerText = (stop.toFixed(4) + "€").replace('.', ',');
                document.getElementById('resRiesgoReal').innerText = "-" + riesgoRealEuros.toFixed(2) + " €";
                document.getElementById('resTarget').innerText = (targetPrecio.toFixed(4) + " €").replace('.', ',');
                document.getElementById('resBeneficioReal').innerText = "+" + beneficioRealEuros.toFixed(2) + " €";
                document.getElementById('resActivacion').innerText = (puntoBE.toFixed(4) + " €").replace('.', ',');
            } else {
                const fields = ['resAcciones', 'resInversion', 'resStopPrecio', 'resRiesgoReal', 'resTarget', 'resBeneficioReal', 'resActivacion'];
                fields.forEach(f => document.getElementById(f).innerText = "---");
            }
        }
        window.onload = calcular;

        // document.addEventListener("DOMContentLoaded", function() {
        //     const StoreService = window.StoreService;
        //     const UtilsService = window.UtilsService;

        //     let FULL_DATA = StoreService.get(UtilsService.CONSTANT.SESSION.CHART_DATA);

        //     if (!FULL_DATA) {
        //         document.getElementById('capital').value =  2000;
        //     }
        //     const currentCapital = FULL_DATA[FULL_DATA.length - 1].current;
        //     document.getElementById('capital').value = Math.round(currentCapital);
        // });
    </script>
</body>

</html>